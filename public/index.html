<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.js"></script>
<button onclick="createRoom()">Crear Sala (Doctor)</button>
<button onclick="joinRoom()">Unirse a Sala (Paciente)</button>
<p id="roomLink"></p>

<script>
    const socket = io("https://be59-190-69-48-119.ngrok-free.app");

    function createRoom() {
        const role = "doctor";
        console.log("üõ†Ô∏è Creando sala con rol:", role);
        socket.emit("create-room", role);
    }

    function joinRoom() {
        const roomId = prompt("üîë Ingresa el ID de la sala:");
        if (roomId) {
            const role = "paciente";
            console.log("üîó Uni√©ndose a la sala:", roomId, "como", role);
            socket.emit("join-room", { roomId, role });
        }
    }

    // ‚úÖ Recibir la respuesta del servidor con el ID de la sala creada
    socket.on("room-created", (roomId) => {
        console.log("‚úÖ Sala creada con ID:", roomId);
        
        // üìå Generar un enlace din√°mico para compartir
        const roomLink = `${window.location.origin}/prueba.html?roomId=${roomId}`;
        document.getElementById("roomLink").innerHTML = `
            <a href="${roomLink}" target="_blank">${roomLink}</a>
            <button onclick="copyToClipboard('${roomLink}')">Copiar</button>
        `;
    });

    function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
            alert("üìã Enlace copiado al portapapeles");
        }).catch(err => {
            console.error("‚ùå Error al copiar:", err);
        });
    }
</script>
